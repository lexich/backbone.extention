/*
backbone.extention - v0.0.4 -
2013-10-16
author: lexich
*/
(function(){Backbone.View.prototype.extention={__super__ensureElement:Backbone.View.prototype._ensureElement,initPtr:function(){return null!=this.VIEW_PTR?this.$el.data(this.VIEW_PTR,this):void 0},initTemplateLoader:function(){var $templateEl,data;return null!=this.templatePath&&($templateEl=$(this.templatePath),this.templateContent=$templateEl.html()),null==this.templateContent||this.templateCompiled||(this.templateProcessor||(this.templateProcessor=_.template),this.templateCompiled=this.templateProcessor(this.templateContent)),null!=this.templateCompiled?(data=null!=this.templateData?_.result(this,"templateData"):{},this.$el.html(this.templateCompiled(data))):null!=this.templateContent?this.$el.html(this.templateContent):void 0},initImgLoadAnimation:function($imgs,options){var _this=this;return null==options&&(options=this.imgLoadAnimation),null!=this.options?(null==$imgs&&($imgs=this.$el.find("img")),_.each(options,function(opt,selector){var $item;return $item="this"===selector||"self"===selector?_this.$el:$(selector,_this.$el),null!=opt.defaultClass&&$item.addClass(opt.defaultClass),null!=opt.defaultCSS?$item.css(opt.defaultCSS):void 0}),$imgs.load(_.bind(this.extention.eventImgLoadAnimation,this))):void 0},initDomLinks:function(){var _this=this;if(null!=this.domLinks)return this.$d={},_.each(this.domLinks,function(selector,name){return _this.$d[name]=$(selector,_this.$el)}),this.d=function(name){return $(this.domLinks[name],this.$el)}},bindContext:function(ctx,param){var func;return func=_.isString(param)?ctx[param]:param,null!=func?_.bind(func,ctx):null},eventImgLoadAnimation:function(e){var $img,options,_this=this;return $img=$(e.target),options=this.imgLoadAnimation,_.each(options,function(opt,selector){var $item,afterRender,beforeRender,className,complete,jsOptions;return beforeRender=_this.extention.bindContext(_this,opt.beforeRender),afterRender=_this.extention.bindContext(_this,opt.afterRender),complete=_this.extention.bindContext(_this,opt.complete),$item="this"===selector||"self"===selector?_this.$el:$(selector,_this.$el),"function"==typeof beforeRender&&beforeRender($item,opt),null!=opt.css&&(className=_.isString(opt.css)?opt.css:opt.css["class"]||"",$item.addClass(className),"function"==typeof afterRender&&afterRender($item,opt)),null!=opt.js?(jsOptions=_.defaults({properties:{opacity:1},duration:400,easing:"swing"},opt.js),null!=complete&&(jsOptions.complete=complete),$item.animate(jsOptions.properties,_.omit(jsOptions,"properties")),"function"==typeof afterRender?afterRender($item,opt):void 0):void 0})}},Backbone.View.prototype._ensureElement=function(){return this.extention.__super__ensureElement.call(this),this.extention.initPtr.call(this),this.extention.initTemplateLoader.call(this),this.extention.initDomLinks.call(this),this.extention.initImgLoadAnimation.call(this)}}).call(this);